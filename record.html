<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é€²æ— - AIå‹‰å¼·ç®¡ç†</title>
  <style>
    body { font-family: sans-serif; background: #e0f2ff; display: flex; flex-direction: column; align-items: center; padding: 0; margin: 0; }
    .nav { width: 100%; background: #fff; display: flex; justify-content: space-around; padding: 10px 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: sticky; top: 0; }
    .btn-nav { color: #3b82f6; text-decoration: none; font-size: 14px; font-weight: bold; padding: 5px 10px; }
    .btn-nav.active { color: #1e40af; border-bottom: 2px solid #1e40af; }
    
    .container { width: 95%; max-width: 450px; padding: 20px; box-sizing: border-box; background: white; margin-top: 20px; border-radius: 12px; }
    .progress-item { margin-bottom: 25px; }
    .bar-bg { background: #eee; height: 16px; border-radius: 8px; overflow: hidden; margin-top: 8px; }
    .bar-fill { background: #10b981; height: 100%; transition: width 0.8s; }
    .stats { display: flex; justify-content: space-between; font-weight: bold; }
  </style>
</head>
<body>

  <nav class="nav">
    <a href="select_subject.html" class="btn-nav">ğŸ“š æ•™æ</a>
    <a href="record.html" class="btn-nav active">ğŸ“Š é€²æ—</a>
    <a href="ranking.html" class="btn-nav">ğŸ† ãƒ©ãƒ³ã‚¯</a>
  </nav>

  <div class="container">
    <h2 style="text-align:center; color:#1a73e8; margin-top:0;">ğŸ“Š å­¦ç¿’é€²æ—</h2>
    <div id="list"></div>
  </div>

<script>
  const records = JSON.parse(localStorage.getItem('studyRecords') || "[]");
  const summary = {};
  records.forEach(r => {
    if(!summary[r.subject]) summary[r.subject] = { solved: new Set(), total: r.totalCount };
    r.num.split(',').forEach(n => { if(n.trim()) summary[r.subject].solved.add(n.trim()); });
  });

  const list = document.getElementById('list');
  Object.keys(summary).forEach(subj => {
    const s = summary[subj];
    const percent = s.total > 0 ? Math.min(Math.round((s.solved.size / s.total) * 100), 100) : 0;
    list.innerHTML += `
      <div class="progress-item">
        <div class="stats"><span>${subj}</span><span>${percent}%</span></div>
        <div class="bar-bg"><div class="bar-fill" style="width:${percent}%"></div></div>
        <div style="font-size:0.8rem; color:#666; margin-top:5px;">${s.solved.size} / ${s.total} å• å®Œäº†</div>
      </div>`;
  });
</script>
</body>
</html>